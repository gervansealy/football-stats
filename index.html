<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Football Season Player Database</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="loginScreen" class="login-screen">
        <div class="floating-icons">
            <div class="icon trophy" style="left: 15%; top: 15%;">üèÜ</div>
            <div class="icon worldcup" style="left: 45%; top: 10%;">üèÜ</div>
            <div class="icon champions" style="right: 20%; top: 18%;">üèÜ</div>
            <div class="icon ball" style="left: 10%; top: 35%;">‚öΩ</div>
            <div class="icon ball" style="right: 15%; top: 30%;">‚öΩ</div>
            <div class="icon ball" style="left: 85%; top: 60%;">‚öΩ</div>
            <div class="icon boot" style="left: 8%; bottom: 25%;">üëü</div>
            <div class="icon boot-gold" style="right: 12%; bottom: 30%;">üëü</div>
            <div class="icon whistle" style="left: 25%; top: 25%;">üéΩ</div>
            <div class="icon card" style="right: 25%; bottom: 20%;">üÉè</div>
            <div class="icon clock" style="right: 8%; top: 45%;">‚è∞</div>
            <div class="icon goal" style="left: 5%; top: 55%;">ü•Ö</div>
        </div>
        <div class="login-container">
            <h1>Football Season Player Database</h1>
            <div class="login-form">
                <input type="password" id="passwordInput" placeholder="Enter Password" />
                <button onclick="login()">Login</button>
                <div id="loginError" class="error-message"></div>
            </div>
        </div>
    </div>

    <div id="mainApp" class="main-app" style="display: none;">
        <header>
            <h1>Football Season Player Database</h1>
            <nav>
                <button id="standingsTab" class="tab-btn active" onclick="showTab('standings')">Standings</button>
                <button id="gameHistoryTab" class="tab-btn" onclick="showTab('gameHistory')">Game History</button>
                <button id="inputStatsTab" class="tab-btn" onclick="showTab('inputStats')">Input Stats</button>
                <button id="playerProfilesTab" class="tab-btn" onclick="showTab('playerProfiles')">Player Profiles</button>
                <button id="settingsTab" class="tab-btn" onclick="showTab('settings')">Settings</button>
            </nav>
            <div class="user-info">
                <span class="role-badge" id="roleBadge">üõ°Ô∏è Admin</span>
                <button class="change-role-btn" onclick="logout()">Change Role</button>
            </div>
        </header>

        <main id="mainContent">
            <div id="standingsContent" class="tab-content active">
                <div class="content-header">
                    <h2>Season Standings</h2>
                    <div class="year-selector">
                        <label>Year:</label>
                        <select id="standingsYear" onchange="loadStandings()">
                            <option value="2026">2026</option>
                        </select>
                    </div>
                </div>
                <div class="table-container">
                    <table class="standings-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Player Name</th>
                                <th>Games</th>
                                <th>Wins</th>
                                <th>Draws</th>
                                <th>Losses</th>
                                <th>Clean Sheets</th>
                                <th>Goals</th>
                                <th>Capt. Wins</th>
                                <th>Capt. Draws</th>
                                <th>Capt. Losses</th>
                                <th>W:L Ratio</th>
                                <th>Win %</th>
                                <th>Points</th>
                            </tr>
                        </thead>
                        <tbody id="standingsTableBody">
                            <tr>
                                <td colspan="14" class="no-data">No players added yet</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="inputStatsContent" class="tab-content">
                <h2>Input Game Stats</h2>
                <div class="form-group">
                    <label>Game Date:</label>
                    <input type="date" id="gameDate" />
                </div>
                <div id="playerStatsInputs" class="player-stats-inputs">
                    <p class="no-data">No players added yet. Add players in the Player Profiles section.</p>
                </div>
                <div id="gameFormActions" style="display: none; margin-top: 1rem; gap: 1rem;">
                    <button id="submitStatsBtn" class="btn-primary" onclick="submitGameStats()">Submit All Stats</button>
                    <button id="cancelEditBtn" class="btn-secondary" onclick="cancelEditGame()" style="display: none;">Cancel Edit</button>
                </div>
            </div>

            <div id="gameHistoryContent" class="tab-content">
                <h2>Game History</h2>
                <p class="info-text">View all games and see where players stood in the standings after each match.</p>
                <div id="allGamesHistoryList" class="game-history-list">
                    <p class="no-data">No games recorded yet</p>
                </div>
            </div>

            <div id="playerProfilesContent" class="tab-content">
                <h2>Player Profiles</h2>
                <button class="btn-primary" onclick="showAddPlayerModal()" id="addPlayerBtn">Add New Player</button>
                <div id="playerProfilesList" class="player-profiles-list">
                    <p class="no-data">No players added yet.<br>Click "Add New Player" to get started.</p>
                </div>
            </div>

            <div id="settingsContent" class="tab-content">
                <h2>Point Values Configuration</h2>
                <div class="settings-form">
                    <div class="form-group">
                        <label>Win Points:</label>
                        <input type="number" id="winPoints" />
                    </div>
                    <div class="form-group">
                        <label>Draw Points:</label>
                        <input type="number" id="drawPoints" />
                    </div>
                    <div class="form-group">
                        <label>Loss Points:</label>
                        <input type="number" id="lossPoints" />
                    </div>
                    <div class="form-group">
                        <label>Clean Sheet Points:</label>
                        <input type="number" id="cleanSheetPoints" />
                    </div>
                    <div class="form-group">
                        <label>Goal Points (per goal):</label>
                        <input type="number" id="goalPoints" />
                    </div>
                    <div class="form-group">
                        <label>Captain Win Points:</label>
                        <input type="number" id="captainWinPoints" />
                    </div>
                    <div class="form-group">
                        <label>Captain Draw Points:</label>
                        <input type="number" id="captainDrawPoints" />
                    </div>
                    <div class="form-group">
                        <label>Captain Loss Points:</label>
                        <input type="number" id="captainLossPoints" />
                    </div>
                    <button class="btn-primary" onclick="saveSettings()">Save Settings</button>
                </div>

                <div class="admin-section" id="adminSection">
                    <h3>Admin Settings</h3>
                    <div class="form-group">
                        <label>Admin Password:</label>
                        <input type="password" id="adminPassword" />
                    </div>
                    <div class="form-group">
                        <label>Viewer Password:</label>
                        <input type="password" id="viewerPassword" />
                    </div>
                    <button class="btn-primary" onclick="savePasswords()">Update Passwords</button>
                </div>
            </div>
        </main>
    </div>

    <div id="addPlayerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Add New Player</h2>
                <button class="close-btn" onclick="closeAddPlayerModal()">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editPlayerId" />
                <div class="form-group">
                    <label>First Name:</label>
                    <input type="text" id="playerFirstName" />
                </div>
                <div class="form-group">
                    <label>Last Name:</label>
                    <input type="text" id="playerLastName" />
                </div>
                <div class="form-group">
                    <label>Position:</label>
                    <input type="text" id="playerPosition" />
                </div>
                <div class="form-group">
                    <label>Height (ft'in"):</label>
                    <input type="text" id="playerHeight" placeholder="e.g., 5'10&quot;" />
                </div>
                <div class="form-group">
                    <label>Weight (lbs):</label>
                    <input type="number" id="playerWeight" />
                </div>
                <div class="form-group">
                    <label>Birthday:</label>
                    <input type="date" id="playerBirthday" />
                </div>
                <div class="form-group">
                    <label>Hobbies:</label>
                    <textarea id="playerHobbies"></textarea>
                </div>
                <div class="form-group">
                    <label>Headshot Image Link:</label>
                    <input type="text" id="playerHeadshot" placeholder="Paste image link (Google Drive, Imgur, or direct URL)" />
                    <small style="color: #7f8c8d; font-size: 12px; margin-top: 4px; display: block;">
                        üì∏ For Google Drive: Right-click image ‚Üí Share ‚Üí "Anyone with the link" ‚Üí Copy link
                    </small>
                </div>
                <div class="form-group">
                    <label>Highlight Videos:</label>
                    <div id="videoLinksContainer">
                        <div class="video-link-item">
                            <input type="text" class="video-link-input" placeholder="Paste video link (YouTube or Google Drive)" />
                            <button type="button" class="btn-small btn-danger" onclick="removeVideoLink(this)" style="display:none;">Remove</button>
                        </div>
                    </div>
                    <button type="button" class="btn-small" onclick="addVideoLink()" style="margin-top: 0.5rem;">+ Add Another Video</button>
                    <small style="color: #7f8c8d; font-size: 12px; margin-top: 4px; display: block;">
                        üé• YouTube links recommended for best compatibility
                    </small>
                </div>
                <button id="savePlayerBtn" class="btn-primary" onclick="savePlayer()">Add Player</button>
            </div>
        </div>
    </div>

    <div id="gameDetailsModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h2 id="gameDetailsTitle">Game Details</h2>
                <button class="close-btn" onclick="closeGameDetailsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="game-details-actions" id="gameDetailsActions">
                    <button class="btn-warning" onclick="editGame()">Edit Game</button>
                    <button class="btn-danger" onclick="deleteGame()">Delete Game</button>
                </div>
                
                <div class="game-details-grid">
                    <div class="game-details-section">
                        <h3 class="section-title">Player Performance</h3>
                        <div id="gamePlayerStatsContent"></div>
                    </div>
                    
                    <div class="game-details-section">
                        <h3 class="section-title">Standings After This Game</h3>
                        <div class="table-container">
                            <table class="standings-table compact">
                                <thead>
                                    <tr>
                                        <th>Rank</th>
                                        <th>Player</th>
                                        <th>GP</th>
                                        <th>W</th>
                                        <th>D</th>
                                        <th>L</th>
                                        <th>Pts</th>
                                    </tr>
                                </thead>
                                <tbody id="gameStandingsTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="playerProfileModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h2 id="playerProfileTitle">Player Profile</h2>
                <button class="close-btn" onclick="closePlayerProfileModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="playerProfileContent"></div>
            </div>
        </div>
    </div>

    <div id="videoModal" class="modal">
        <div class="modal-content video-modal">
            <div class="modal-header">
                <h2 id="videoModalTitle">Highlight Video</h2>
                <button class="close-btn" onclick="closeVideoModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="videoPlayerContainer">
                    <video id="videoPlayer" controls controlsList="nodownload">
                        <source id="videoSource" src="" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                    <div id="videoIframeContainer"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script src="app.js"></script>
</body>
</html>
